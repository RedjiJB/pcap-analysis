# Malware C2 Communication Analysis

**Analyst**: Your Name  
**Date**: 2024-01-15  
**PCAP Source**: Malware-Traffic-Analysis.net - Emotet infection  
**Duration**: 2 hours (14:00 - 16:00 UTC)

## Executive Summary

This analysis identifies and documents Command & Control (C2) communication patterns from an Emotet malware infection. The infected host established persistent connections to multiple C2 servers, exhibiting classic beacon behavior with data exfiltration indicators.

## Key Findings

### 1. Infected Host Identification
- **IP Address**: 192.168.1.105
- **Hostname**: DESKTOP-INFECTED
- **MAC Address**: 08:00:27:1a:2b:3c
- **OS Fingerprint**: Windows 10 (based on TTL and TCP options)

### 2. C2 Servers Identified

| IP Address | Port | First Contact | Beacon Interval | Threat Intel |
|------------|------|---------------|-----------------|--------------|
| 185.234.218.84 | 443 | 14:15:32 | ~300s | Known Emotet C2 |
| 91.243.80.142 | 8080 | 14:18:45 | ~180s | Malicious (VirusTotal) |
| 5.182.210.145 | 7080 | 14:22:10 | ~300s | New IOC |

### 3. Communication Pattern Analysis

**[14:15:32]** Initial HTTP POST to 185.234.218.84
- User-Agent: "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1)"
- Suspicious: Outdated IE7 user agent on Win10 system
- POST data: Base64 encoded, likely system info

**[14:15:35]** Server response with encrypted payload
- Content-Type: application/octet-stream
- Size: 284KB (likely malware module)

**[14:18:00-16:00:00]** Beacon pattern established
- Regular HTTPS connections every 5 minutes (Â±10s)
- Small upstream data (200-500 bytes)
- Varying downstream responses (0-50KB)

### 4. Data Exfiltration Indicators

**DNS Queries for DGA domains:**
```
14:45:12 - Query: nf4k2lmao5ca3lmn.com
14:45:18 - Query: pj4ko3lnp5fa4zmr.net
14:45:24 - Query: qk5lp4moq6gb5ann.org
```

**Large data transfers:**
- 15:12:45 - 15.3MB uploaded to 91.243.80.142:8080
- 15:38:20 - 8.7MB uploaded to 185.234.218.84:443

### 5. Lateral Movement Attempts

SMB scanning detected from infected host:
```
15:45:00-15:47:30 - Port 445 scans to 192.168.1.0/24
Targets: 192.168.1.101, .102, .103, .110, .115
```

## Timeline of Events

**14:00:00** - PCAP capture started
**14:15:30** - First suspicious outbound connection
**14:15:32** - Initial C2 contact established
**14:18:45** - Secondary C2 server contacted
**14:45:00** - DGA domain queries begin
**15:12:45** - Large data exfiltration event
**15:45:00** - Lateral movement scanning
**16:00:00** - PCAP capture ended

## Wireshark Filters Used

```wireshark
# C2 beacon detection
ip.addr == 192.168.1.105 && (tcp.port == 443 || tcp.port == 8080 || tcp.port == 7080)

# DNS DGA detection
dns.qry.name matches "^[a-z0-9]{16}\.(com|net|org)$"

# Data exfiltration
ip.src == 192.168.1.105 && tcp.len > 1000

# SMB lateral movement
ip.src == 192.168.1.105 && tcp.dstport == 445
```

## Indicators of Compromise (IOCs)

### Network IOCs
```
# C2 Servers
185.234.218.84:443
91.243.80.142:8080
5.182.210.145:7080

# DGA Domains
nf4k2lmao5ca3lmn.com
pj4ko3lnp5fa4zmr.net
qk5lp4moq6gb5ann.org

# User Agents
Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1)
```

### Behavioral IOCs
- HTTP POST to non-standard ports (7080, 8080)
- Regular beacon intervals (180-300 seconds)
- Base64 encoded POST data
- DGA domain queries
- SMB scanning on local network

## Recommendations

1. **Immediate Actions**
   - Isolate infected host (192.168.1.105)
   - Block C2 IPs at firewall
   - DNS sinkhole DGA domains

2. **Investigation Steps**
   - Memory dump of infected host
   - Check for persistence mechanisms
   - Review proxy logs for additional C2 domains

3. **Prevention Measures**
   - Update endpoint detection rules
   - Implement beacon detection
   - Monitor for unusual user agents

## Appendix: Evidence Screenshots

![Wireshark C2 Traffic](../screenshots/emotet-c2-traffic.png)
*Figure 1: C2 beacon pattern in Wireshark*

![IOC Timeline](../screenshots/emotet-timeline.png)
*Figure 2: Attack timeline visualization*

---
*Report generated using automated PCAP analysis tools and manual verification*