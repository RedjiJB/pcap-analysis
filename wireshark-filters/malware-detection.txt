# Malware Detection Filters for Wireshark

# Suspicious HTTP User-Agents
http.user_agent contains "Mozilla/4.0" or http.user_agent contains "Wget" or http.user_agent contains "python" or http.user_agent contains "curl"

# Non-standard ports for HTTP/HTTPS
tcp.port == 4444 or tcp.port == 5555 or tcp.port == 8080 or tcp.port == 7080

# Base64 in HTTP POST requests
http.request.method == "POST" and http contains "base64"

# Suspicious file extensions in HTTP traffic
http.request.uri contains ".exe" or http.request.uri contains ".dll" or http.request.uri contains ".scr" or http.request.uri contains ".bat"

# TLS/SSL on non-standard ports
ssl and not (tcp.port == 443 or tcp.port == 993 or tcp.port == 995 or tcp.port == 465)

# IRC traffic (common C2 channel)
tcp.port == 6667 or tcp.port == 6697

# Reverse shells
tcp.dstport == 4444 or tcp.dstport == 4445 or tcp.dstport == 1337

# Metasploit default ports
tcp.port == 4444 or tcp.port == 4445 or tcp.port == 55553

# Suspicious outbound connections from internal network
ip.src == 192.168.0.0/16 and tcp.flags.syn == 1 and not (tcp.dstport == 80 or tcp.dstport == 443 or tcp.dstport == 53)

# Large POST requests (potential data exfiltration)
http.request.method == "POST" and http.content_length > 10000